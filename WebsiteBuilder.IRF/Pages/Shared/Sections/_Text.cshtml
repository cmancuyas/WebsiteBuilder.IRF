@model WebsiteBuilder.Models.PageSection
@using System.Text.Json

@{
    string? text = null;

    // ✅ Phase 2 canonical payload
    if (!string.IsNullOrWhiteSpace(Model.SettingsJson))
    {
        try
        {
            using var doc = JsonDocument.Parse(Model.SettingsJson);

            if (doc.RootElement.ValueKind == JsonValueKind.Object &&
                doc.RootElement.TryGetProperty("text", out var t) &&
                t.ValueKind == JsonValueKind.String)
            {
                text = t.GetString();
            }
        }
        catch
        {
            <div class="alert alert-danger">
                Invalid Text JSON content.
            </div>
            return;
        }
    }
}

<section class="py-4">
    <div class="container">
        @if (!string.IsNullOrWhiteSpace(text))
        {
            <p class="mb-0">@text</p>
        }
    </div>
</section>
