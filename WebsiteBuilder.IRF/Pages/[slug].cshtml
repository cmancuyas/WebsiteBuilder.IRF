@page "/{slug?}"
@model WebsiteBuilder.IRF.Pages._slug_Model

@{
    Layout = "_Layout"; // adjust if needed
    var isPreview = Model.IsPreview;
}

@section Head {
    @if (isPreview)
    {
        <meta name="robots" content="noindex,nofollow,noarchive,nosnippet" />
        <meta name="googlebot" content="noindex,nofollow,noarchive,nosnippet" />
    }
}

@if (isPreview)
{
    var exitUrl = Request.Path; // same page, without querystring

    <div style="position:sticky;top:0;z-index:1050;background:#111827;color:#fff;padding:10px 16px;border-bottom:1px solid rgba(255,255,255,.15);">
        <div class="container d-flex align-items-center justify-content-between">
            <div>
                <strong>Draft Preview Mode</strong>
                <span class="ms-2" style="opacity:.85;">You are viewing draft content.</span>
            </div>

            <div class="d-flex align-items-center gap-2">
                <a class="btn btn-sm btn-light" href="@exitUrl">Exit preview</a>

                <a class="btn btn-sm btn-outline-light"
                   href="/Admin/Pages/Edit/@Model.PageEntity!.Id">
                    Back to Edit
                </a>
            </div>
        </div>
    </div>
}


@foreach (var section in Model.RenderSections)
{
    @await Component.InvokeAsync(
    "PageSection",
        new
        {
            sectionTypeId = section.SectionTypeId,
            settingsJson = section.SettingsJson
        })
}
